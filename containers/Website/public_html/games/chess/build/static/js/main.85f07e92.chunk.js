(this["webpackJsonpreact-chess"]=this["webpackJsonpreact-chess"]||[]).push([[0],{36:function(e,t,s){e.exports=s(85)},41:function(e,t,s){e.exports=s.p+"static/media/white_bishop.28e8d8aa.svg"},42:function(e,t,s){e.exports=s.p+"static/media/black_bishop.749373a9.svg"},43:function(e,t,s){e.exports=s.p+"static/media/white_king.31362a80.svg"},44:function(e,t,s){e.exports=s.p+"static/media/black_king.ea645f11.svg"},45:function(e,t,s){e.exports=s.p+"static/media/white_knight.3ece5029.svg"},46:function(e,t,s){e.exports=s.p+"static/media/black_knight.88ad52be.svg"},47:function(e,t,s){e.exports=s.p+"static/media/white_pawn.27d127d0.svg"},48:function(e,t,s){e.exports=s.p+"static/media/black_pawn.44553199.svg"},49:function(e,t,s){e.exports=s.p+"static/media/white_queen.01938cfd.svg"},50:function(e,t,s){e.exports=s.p+"static/media/black_queen.9fbe0beb.svg"},51:function(e,t,s){e.exports=s.p+"static/media/white_rook.007b43f5.svg"},52:function(e,t,s){e.exports=s.p+"static/media/black_rook.e7f61dec.svg"},82:function(e,t){},85:function(e,t,s){"use strict";s.r(t);var a=s(0),i=s.n(a),n=s(34),r=s.n(n),o=(s(9),s(7)),l=s(1),c=s(2),h=s(6),u=s(4),v=s(3);function f(e){return i.a.createElement("button",{className:"square "+e.shade,onClick:e.onClick,style:e.style})}var p=function(e){Object(u.a)(s,e);var t=Object(v.a)(s);function s(){return Object(l.a)(this,s),t.apply(this,arguments)}return Object(c.a)(s,[{key:"renderSquare",value:function(e,t){var s=this;return i.a.createElement(f,{style:this.props.squares[e]?this.props.squares[e].style:null,shade:t,onClick:function(){return s.props.onClick(e)}})}},{key:"render",value:function(){for(var e=[],t=0;t<8;t++){for(var s=[],a=0;a<8;a++){var n=g(t)&&g(a)||!g(t)&&!g(a)?"light-square":"dark-square";s.push(this.renderSquare(8*t+a,n))}e.push(i.a.createElement("div",{className:"board-row"},s))}return i.a.createElement("div",{id:"centered"},e)}}]),s}(i.a.Component);function g(e){return e%2===0}var b=function(e){Object(u.a)(s,e);var t=Object(v.a)(s);function s(){return Object(l.a)(this,s),t.apply(this,arguments)}return Object(c.a)(s,[{key:"renderSquare",value:function(e,t,s){return i.a.createElement(f,{piece:e,style:e.style})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("div",{className:"board-row"},this.props.whiteFallenSoldiers.map((function(t,s){return e.renderSquare(t,s)}))),i.a.createElement("div",{className:"board-row"},this.props.blackFallenSoldiers.map((function(t,s){return e.renderSquare(t,s)}))))}}]),s}(i.a.Component),S=function e(t,s){Object(l.a)(this,e),this.player=t,this.style={backgroundImage:"url('"+s+"')"}},d=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){return Object(l.a)(this,a),t.call(this,e,s(1===e?41:42))}return Object(c.a)(a,[{key:"isMovePossible",value:function(e,t){return Math.abs(e-t)%9===0||Math.abs(e-t)%7===0}},{key:"getSrcToDestPath",value:function(e,t){var s,a,i,n=[];e>t?(s=t,a=e):(s=e,a=t),Math.abs(e-t)%9===0?(i=9,s+=9):(i=7,s+=7);for(var r=s;r<a;r+=i)n.push(r);return n}}]),a}(S),k=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){return Object(l.a)(this,a),t.call(this,e,s(1===e?43:44))}return Object(c.a)(a,[{key:"isMovePossible",value:function(e,t){return e-9===t||e-8===t||e-7===t||e+1===t||e+9===t||e+8===t||e+7===t||e-1===t}},{key:"getSrcToDestPath",value:function(e,t){return[]}}]),a}(S),y=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){return Object(l.a)(this,a),t.call(this,e,s(1===e?45:46))}return Object(c.a)(a,[{key:"isMovePossible",value:function(e,t){return e-17===t||e-10===t||e+6===t||e+15===t||e-15===t||e-6===t||e+10===t||e+17===t}},{key:"getSrcToDestPath",value:function(){return[]}}]),a}(S),m=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){var i;return Object(l.a)(this,a),(i=t.call(this,e,s(1===e?47:48))).initialPositions={1:[48,49,50,51,52,53,54,55],2:[8,9,10,11,12,13,14,15]},i}return Object(c.a)(a,[{key:"isMovePossible",value:function(e,t,s){if(1===this.player){if(t===e-8&&!s||t===e-16&&-1!==this.initialPositions[1].indexOf(e))return!0;if(s&&(t===e-9||t===e-7))return!0}else if(2===this.player){if(t===e+8&&!s||t===e+16&&-1!==this.initialPositions[2].indexOf(e))return!0;if(s&&(t===e+9||t===e+7))return!0}return!1}},{key:"getSrcToDestPath",value:function(e,t){return t===e-16?[e-8]:t===e+16?[e+8]:[]}}]),a}(S),P=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){return Object(l.a)(this,a),t.call(this,e,s(1===e?49:50))}return Object(c.a)(a,[{key:"isMovePossible",value:function(e,t){var s=e%8,a=8-s;return Math.abs(e-t)%9===0||Math.abs(e-t)%7===0||Math.abs(e-t)%8===0||t>=e-s&&t<e+a}},{key:"getSrcToDestPath",value:function(e,t){var s,a,i,n=[];e>t?(s=t,a=e):(s=e,a=t),Math.abs(e-t)%8===0?(i=8,s+=8):Math.abs(e-t)%9===0?(i=9,s+=9):Math.abs(e-t)%7===0?(i=7,s+=7):(i=1,s+=1);for(var r=s;r<a;r+=i)n.push(r);return n}}]),a}(S),w=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){return Object(l.a)(this,a),t.call(this,e,s(1===e?51:52))}return Object(c.a)(a,[{key:"isMovePossible",value:function(e,t){var s=e%8,a=8-s;return Math.abs(e-t)%8===0||t>=e-s&&t<e+a}},{key:"getSrcToDestPath",value:function(e,t){var s,a,i,n=[];e>t?(s=t,a=e):(s=e,a=t),Math.abs(e-t)%8===0?(i=8,s+=8):(i=1,s+=1);for(var r=s;r<a;r+=i)n.push(r);return n}}]),a}(S);function M(){for(var e=Array(64).fill(null),t=8;t<16;t++)e[t]=new m(2),e[t+40]=new m(1);return e[0]=new w(2),e[7]=new w(2),e[56]=new w(1),e[63]=new w(1),e[1]=new y(2),e[6]=new y(2),e[57]=new y(1),e[62]=new y(1),e[2]=new d(2),e[5]=new d(2),e[58]=new d(1),e[61]=new d(1),e[3]=new P(2),e[4]=new k(2),e[59]=new P(1),e[60]=new k(1),e}var T=s(35),D=s.n(T);function O(e,t){var s={query:"token="+t},a=D()(e,s);return{socket:a,connectionStatus:a.connected?0:-1}}function j(e){var t=[];if(e)for(var s=0;s<e.length;s++){var a=e[s].toString().split(" ");switch(a[0]){case"King":t.push(new k(parseInt(a[1])));break;case"Pawn":t.push(new m(parseInt(a[1])));break;case"Queen":t.push(new P(parseInt(a[1])));break;case"Bishop":t.push(new d(parseInt(a[1])));break;case"Knight":t.push(new y(parseInt(a[1])));break;case"Rook":t.push(new w(parseInt(a[1])));break;default:t.push(null)}}return t}var q=function(e){Object(u.a)(s,e);var t=Object(v.a)(s);function s(e){var a;Object(l.a)(this,s),a=t.call(this,e);var i,n=function(){var e=window.location.href,t=new URL(e),s=t.hostname,a=t.searchParams.get("pm"),i=t.searchParams.get("gm");return{host:s,token:t.searchParams.get("token"),playmanster:a,gamemaster:i}}(),r=O(n.host+":"+n.playmanster,n.token);return a.state={squares:M(),whiteFallenSoldiers:[],blackFallenSoldiers:[],player:1,sourceSelection:-1,kingStatus:"",turn:"white",type:null,myTurn:!1,changePawn:-1,host:n.host,gamemaster:n.gamemaster,token:n.token,socket:r.socket,status:"",connectionStatus:r.connectionStatus,progress:0,roundID:null,endstate:0},a.setBishop=a.setBishop.bind(Object(h.a)(a)),a.setQueen=a.setQueen.bind(Object(h.a)(a)),a.setKnight=a.setKnight.bind(Object(h.a)(a)),a.setRook=a.setRook.bind(Object(h.a)(a)),(i=Object(h.a)(a)).state.socket.on("wait",(function(e){i.setState({connectionStatus:1,roundID:e.roundID})})),i.state.socket.on("init",(function(e){null===i.state.type?i.setState({connectionStatus:2,myTurn:e.turn,roundID:e.roundID,myColor:e.turn?"white":"black"}):i.setState({connectionStatus:2,roundID:e.roundID})})),i.state.socket.on("viewer",(function(e){console.log("VIWER");var t=j(e);i.setState({connectionStatus:5,squares:t,myTurn:!1})})),i.state.socket.on("board",(function(e){var t,s,a=j(e.board),n=j(e.whiteFallenSoldiers),r=j(e.blackFallenSoldiers);e.dontChange?(t=i.state.turn,s=i.state.player):(t="white"===i.state.turn?"black":"white",s=1===i.state.player?2:1),console.log(e.board),console.log(a),i.setState({squares:a,turn:t,whiteFallenSoldiers:n,blackFallenSoldiers:r,status:e.status,kingStatus:e.kingStatus,player:s,myTurn:!0}),1===e.progress?i.setState({connectionStatus:3,endstate:1}):2===e.progress&&i.setState({connectionStatus:3,endstate:2})})),i.state.socket.on("disconnect",(function(e){if(!(i.state.connectionStatus<0||i.state.connectionStatus>2)){i.state.socket.disconnect(),i.setState({connectionStatus:4});var t=new XMLHttpRequest;t.onload=function(e){if(4===t.readyState)if(200===t.connectionStatus){var s=JSON.parse(t.responseText);i.reconnect(s.playmaster)}else 403===t.connectionStatus&&i.setState({connectionStatus:-3,endstate:1})};var s="http://"+i.state.host+":"+i.state.gamemaster+"?token="+i.state.token+"&game=chess";t.open("GET",s),t.send()}})),i.state.socket.on("endgame",(function(e){i.setState({connectionStatus:4}),i.state.socket.disconnect()})),a}return Object(c.a)(s,[{key:"handleClick",value:function(e){if(this.state.myTurn){var t=this.state.squares.slice();if(-1===this.state.sourceSelection)t[e]&&t[e].player===this.state.player?(t[e].style=Object(o.a)(Object(o.a)({},t[e].style),{},{backgroundColor:"RGB(111,143,114)"}),this.setState({status:"Choose destination for the selected piece",sourceSelection:e})):(this.setState({status:"Wrong selection. Choose player "+this.state.player+" pieces."}),t[e]&&(t[e].style=Object(o.a)(Object(o.a)({},t[e].style),{},{backgroundColor:""})));else if(this.state.sourceSelection>-1)if(t[this.state.sourceSelection].style=Object(o.a)(Object(o.a)({},t[this.state.sourceSelection].style),{},{backgroundColor:""}),t[e]&&t[e].player===this.state.player&&(t[this.state.sourceSelection]instanceof k||t[this.state.sourceSelection]instanceof w)&&(t[e]instanceof k||t[e]instanceof w)){var s=!0;if(1===t[e].player?60===this.state.sourceSelection&&t[this.state.sourceSelection]instanceof k?63!==e&&56!==e&&(s=!1):60===e&&t[e]instanceof k?63!==this.state.sourceSelection&&56!==this.state.sourceSelection&&(s=!1):s=!1:4===this.state.sourceSelection&&t[this.state.sourceSelection]instanceof k?0!==e&&7!==e&&(s=!1):4===e&&t[e]instanceof k?0!==this.state.sourceSelection&&7!==this.state.sourceSelection&&(s=!1):s=!1,s&&(1===t[e].player?63===e||63===this.state.sourceSelection?(t[61]||t[62])&&(s=!1):(t[57]||t[58]||t[59])&&(s=!1):7===e||7===this.state.sourceSelection?(t[5]||t[6])&&(s=!1):(t[1]||t[2]||t[3])&&(s=!1),s))if(1===t[e].player){if(63===e||63===this.state.sourceSelection){for(var a=0;a<t.length;a++)if(t[a]&&t[a].player!==this.state.player){var i=t[a].getSrcToDestPath(a,60),n=t[a].getSrcToDestPath(a,61),r=t[a].getSrcToDestPath(a,62);if(t[a].isMovePossible(a,60,!1)&&this.isMoveLegal(i,t)||t[a].isMovePossible(a,61,!1)&&this.isMoveLegal(n,t)||t[a].isMovePossible(a,62,!1)&&this.isMoveLegal(r,t)){s=!1;break}}}else for(var l=0;l<t.length;l++)if(t[l]&&t[l].player!==this.state.player){var c=t[l].getSrcToDestPath(l,60),h=t[l].getSrcToDestPath(l,59),u=t[l].getSrcToDestPath(l,58);if(t[l].isMovePossible(l,60,!1)&&this.isMoveLegal(c,t)||t[l].isMovePossible(l,59,!1)&&this.isMoveLegal(h,t)||t[l].isMovePossible(l,58,!1)&&this.isMoveLegal(u,t)){s=!1;break}}}else if(7===e||7===this.state.sourceSelection){for(var v=0;v<t.length;v++)if(t[v]&&t[v].player!==this.state.player){var f=t[v].getSrcToDestPath(v,4),p=t[v].getSrcToDestPath(v,5),g=t[v].getSrcToDestPath(v,6);if(t[v].isMovePossible(v,4,!1)&&this.isMoveLegal(f,t)||t[v].isMovePossible(v,5,!1)&&this.isMoveLegal(p,t)||t[v].isMovePossible(v,6,!1)&&this.isMoveLegal(g,t)){s=!1;break}}}else for(var b=0;b<t.length;b++)if(t[b]&&t[b].player!==this.state.player){var S=t[b].getSrcToDestPath(b,4),d=t[b].getSrcToDestPath(b,3),y=t[b].getSrcToDestPath(b,2);if(t[b].isMovePossible(b,4,!1)&&this.isMoveLegal(S,t)||t[b].isMovePossible(b,3,!1)&&this.isMoveLegal(d,t)||t[b].isMovePossible(b,2,!1)&&this.isMoveLegal(y,t)){s=!1;break}}if(s){1===t[e].player?(63===e||63===this.state.sourceSelection?(t[62]=t[60],t[61]=t[63],t[63]=null):(t[58]=t[60],t[59]=t[56],t[56]=null),t[60]=null):(7===e||7===this.state.sourceSelection?(t[6]=t[4],t[5]=t[7],t[7]=null):(t[2]=t[4],t[3]=t[0],t[0]=null),t[4]=null);var P=1===this.state.player?2:1,M="white"===this.state.turn?"black":"white";this.setState({squares:t,player:P,turn:M,type:M,kingStatus:"",myTurn:!this.state.myTurn,changePawn:-1,status:"Castling occured.",sourceSelection:-1});var T=this.classesToStrings(t),D=this.classesToStrings(this.state.whiteFallenSoldiers),O=this.classesToStrings(this.state.blackFallenSoldiers),j={roundID:this.state.roundID,board:T,whiteFallenSoldiers:D,blackFallenSoldiers:O,progress:0};this.state.socket.emit("update",j)}else this.setState({status:"Wrong selection. Castling not allowed.",sourceSelection:-1})}else if(t[e]&&t[e].player===this.state.player)this.setState({status:"Wrong selection. Choose valid source and destination again.",sourceSelection:-1});else{var q=this.state.whiteFallenSoldiers.slice(),C=this.state.blackFallenSoldiers.slice(),I=!!t[e],L=t[this.state.sourceSelection].isMovePossible(this.state.sourceSelection,e,I),E=t[this.state.sourceSelection].getSrcToDestPath(this.state.sourceSelection,e),F=this.isMoveLegal(E,t);if(L&&F){var x=!1,R=!1;null!==t[e]&&(1===t[e].player?(q.push(t[e]),x=!0):(C.push(t[e]),R=!0));var _=!1;"Check."===this.state.kingStatus&&(_=!0);var N=0,K=!1,B=t[e];t[e]=t[this.state.sourceSelection],t[this.state.sourceSelection]=null;var Q=1===this.state.player?2:1,W="white"===this.state.turn?"black":"white";this.setState({sourceSelection:-1,squares:t,whiteFallenSoldiers:q,blackFallenSoldiers:C,myTurn:!this.state.myTurn,player:Q,status:"",kingStatus:"",turn:W,type:W,changePawn:-1});var Y=!0;if(_){for(var J=0;J<t.length;J++)if(t[J]&&t[J]instanceof k&&t[J].player===this.state.player){for(var U=0;U<t.length;U++)if(t[U]&&t[U].player!==this.state.player){var A=t[U].getSrcToDestPath(U,J);if(t[U].isMovePossible(U,J,I)&&this.isMoveLegal(A,t)){t[this.state.sourceSelection]=t[e],t[e]=B,Q=1===this.state.player?1:2,W="white"===this.state.turn?"white":"black",x?q.pop():R&&C.pop(),this.setState({squares:t,whiteFallenSoldiers:q,blackFallenSoldiers:C,player:Q,myTurn:this.state.myTurn,kingStatus:"Check.",status:"Wrong selection. You need to avoid check.",turn:W,type:W}),N=-1,Y=!1;break}}break}}else for(var G=0;G<t.length;G++)if(t[G]&&t[G]instanceof k&&t[G].player===this.state.player){for(var H=0;H<t.length;H++)if(t[H]&&t[H].player!==this.state.player){var V=t[H].getSrcToDestPath(H,G);if(t[H].isMovePossible(H,G,I)&&this.isMoveLegal(V,t)){t[this.state.sourceSelection]=t[e],t[e]=B,Q=1===this.state.player?1:2,W="white"===this.state.turn?"white":"black",x?q.pop():R&&C.pop(),this.setState({squares:t,whiteFallenSoldiers:q,blackFallenSoldiers:C,myTurn:this.state.myTurn,player:Q,kingStatus:"",status:"Wrong selection. You cannot go to check.",turn:W,type:W}),N=-1,Y=!1;break}}break}if(Y){for(var z=0;z<t.length;z++)if(t[z]&&t[z]instanceof k&&t[z].player!==this.state.player){for(var X=0;X<t.length;X++)if(t[X]&&t[X].player===this.state.player){var Z=t[X].getSrcToDestPath(X,z);if(t[X].isMovePossible(X,z,I)&&this.isMoveLegal(Z,t)){for(var $=0;$<t.length;$++)if(t[$]&&t[$].player!==this.state.player)for(var ee=0;ee<Z.length;ee++)if(t[$].isMovePossible($,Z[ee],I)&&this.isMoveLegal(t[$].getSrcToDestPath($,Z[ee]),t)&&!(t[$]instanceof k)){K=!0;break}if(!0===K){var te=0;if((!t[z-1]||z-1===X)&&z-1>=0){for(var se=0;se<t.length;se++)if(t[se]&&t[se].player===this.state.player&&se!==X){var ae=!!t[se];if(t[se].isMovePossible(se,z-1,ae)&&this.isMoveLegal(t[se].getSrcToDestPath(se,z-1),t)){te++;break}}}else te++;if((!t[z+1]||z+1===X)&&z+1<64){for(var ie=0;ie<t.length;ie++)if(t[ie]&&t[ie].player===this.state.player&&ie!==X){var ne=!!t[ie];if(t[ie].isMovePossible(ie,z+1,ne)&&this.isMoveLegal(t[ie].getSrcToDestPath(ie,z+1),t)){te++;break}}}else te++;if((!t[z-7]||z-7===X)&&z-7>=0){for(var re=0;re<t.length;re++)if(t[re]&&t[re].player===this.state.player&&re!==X){var oe=!!t[re];if(t[re].isMovePossible(re,z-7,oe)&&this.isMoveLegal(t[re].getSrcToDestPath(re,z-7),t)){te++;break}}}else te++;if((!t[z+7]||z+7===X)&&z+7<64){for(var le=0;le<t.length;le++)if(t[le]&&t[le].player===this.state.player&&le!==X){var ce=!!t[le];if(t[le].isMovePossible(le,z+7,ce)&&this.isMoveLegal(t[le].getSrcToDestPath(le,z+7),t)){te++;break}}}else te++;if((!t[z-8]||z-8===X)&&z-8>=0){for(var he=0;he<t.length;he++)if(t[he]&&t[he].player===this.state.player&&he!==X){var ue=!!t[he];if(t[he].isMovePossible(he,z-8,ue)&&this.isMoveLegal(t[he].getSrcToDestPath(he,z-8),t)){te++;break}}}else te++;if((!t[z+8]||z+8===X)&&z+8<64){for(var ve=0;ve<t.length;ve++)if(t[ve]&&t[ve].player===this.state.player&&ve!==X){var fe=!!t[ve];if(t[ve].isMovePossible(ve,z+8,fe)&&this.isMoveLegal(t[ve].getSrcToDestPath(ve,z+8),t)){te++;break}}}else te++;if((!t[z-9]||z-9===X)&&z-9>=0){for(var pe=0;pe<t.length;pe++)if(t[pe]&&t[pe].player===this.state.player&&pe!==X){var ge=!!t[pe];if(t[pe].isMovePossible(pe,z-9,ge)&&this.isMoveLegal(t[pe].getSrcToDestPath(pe,z-9),t)){te++;break}}}else te++;if((!t[z+9]||z+9===X)&&z+9<64){for(var be=0;be<t.length;be++)if(t[be]&&t[be].player===this.state.player&&be!==X){var Se=!!t[be];if(t[be].isMovePossible(be,z+9,Se)&&this.isMoveLegal(t[be].getSrcToDestPath(be,z+9),t)){te++;break}}}else te++;8===te&&(K=!1)}!0===K?(this.setState({kingStatus:"Check."}),N=1):(this.setState({kingStatus:"Checkmate."}),N=2);break}}break}for(var de=0,ke=0,ye=0;ye<t.length;ye++)t[ye]&&(1===t[ye].player?ke++:de++);if(1===de&&1===ke)this.setState({kingStatus:"Stalemate."}),N=3;else if(1===de&&1===this.state.player||1===ke&&2===this.state.player)for(var me=0;me<t.length;me++)if(t[me]&&t[me]instanceof k&&t[me].player!==this.state.player){var Pe=0;if(!t[me-1]&&me-1>0){for(var we=0;we<t.length;we++)if(t[we]&&t[we].player===this.state.player){var Me=!!t[we];if(t[we].isMovePossible(we,me-1,Me)&&this.isMoveLegal(t[we].getSrcToDestPath(we,me-1),t)){Pe++;break}}}else Pe++;if(!t[me+1]&&me+1<64){for(var Te=0;Te<t.length;Te++)if(t[Te]&&t[Te].player===this.state.player){var De=!!t[Te];if(t[Te].isMovePossible(Te,me+1,De)&&this.isMoveLegal(t[Te].getSrcToDestPath(Te,me+1),t)){Pe++;break}}}else Pe++;if(!t[me-7]&&me-7>0){for(var Oe=0;Oe<t.length;Oe++)if(t[Oe]&&t[Oe].player===this.state.player){var je=!!t[Oe];if(t[Oe].isMovePossible(Oe,me-7,je)&&this.isMoveLegal(t[Oe].getSrcToDestPath(Oe,me-7),t)){Pe++;break}}}else Pe++;if(!t[me+7]&&me+7<64){for(var qe=0;qe<t.length;qe++)if(t[qe]&&t[qe].player===this.state.player){var Ce=!!t[qe];if(t[qe].isMovePossible(qe,me+7,Ce)&&this.isMoveLegal(t[qe].getSrcToDestPath(qe,me+7),t)){Pe++;break}}}else Pe++;if(!t[me-8]&&me-8>0){for(var Ie=0;Ie<t.length;Ie++)if(t[Ie]&&t[Ie].player===this.state.player){var Le=!!t[Ie];if(t[Ie].isMovePossible(Ie,me-8,Le)&&this.isMoveLegal(t[Ie].getSrcToDestPath(Ie,me-8),t)){Pe++;break}}}else Pe++;if(!t[me+8]&&me+8<64){for(var Ee=0;Ee<t.length;Ee++)if(t[Ee]&&t[Ee].player===this.state.player){var Fe=!!t[Ee];if(t[Ee].isMovePossible(Ee,me+8,Fe)&&this.isMoveLegal(t[Ee].getSrcToDestPath(Ee,me+8),t)){Pe++;break}}}else Pe++;if(!t[me-9]&&me-9>0){for(var xe=0;xe<t.length;xe++)if(t[xe]&&t[xe].player===this.state.player){var Re=!!t[xe];if(t[xe].isMovePossible(xe,me-9,Re)&&this.isMoveLegal(t[xe].getSrcToDestPath(xe,me-9),t)){Pe++;break}}}else Pe++;if(!t[me+9]&&me+9<64){for(var _e=0;_e<t.length;_e++)if(t[_e]&&t[_e].player===this.state.player){var Ne=!!t[_e];if(t[_e].isMovePossible(_e,me+9,Ne)&&this.isMoveLegal(t[_e].getSrcToDestPath(_e,me+9),t)){Pe++;break}}}else Pe++;8===Pe&&(this.setState({kingStatus:"Stalemate."}),N=3);break}if(1===this.state.player){for(var Ke=0;Ke<8;Ke++)if(t[Ke]&&1===t[Ke].player&&t[Ke]instanceof m){this.setState({changePawn:Ke});break}}else for(var Be=56;Be<64;Be++)if(t[Be]&&2===t[Be].player&&t[Be]instanceof m){this.setState({changePawn:Be});break}}if(-1!==N){T=this.classesToStrings(t),D=this.classesToStrings(q),O=this.classesToStrings(C);var Qe={roundID:this.state.roundID,board:T,whiteFallenSoldiers:D,blackFallenSoldiers:O,kingStatus:"",progress:0};2===N?Qe={roundID:this.state.roundID,board:T,kingStatus:"Checkmate.",whiteFallenSoldiers:D,blackFallenSoldiers:O,progress:1}:3===N?Qe={roundID:this.state.roundID,board:T,kingStatus:"Stalemate.",whiteFallenSoldiers:D,blackFallenSoldiers:O,progress:2}:1===N&&(Qe={roundID:this.state.roundID,board:T,whiteFallenSoldiers:D,blackFallenSoldiers:O,kingStatus:"Check.",progress:0}),this.state.socket.emit("update",Qe)}}else this.setState({status:"Wrong selection. Choose valid source and destination again.",sourceSelection:-1})}}}},{key:"isMoveLegal",value:function(e,t){for(var s=!0,a=0;a<e.length;a++)null!==t[e[a]]&&(s=!1);return s}},{key:"classesToStrings",value:function(e){console.log("squares"),console.log(e);for(var t=[],s=0;s<e.length;s++)e[s]?e[s]instanceof k?1===e[s].player?t.push("King 1"):t.push("King 2"):e[s]instanceof m?1===e[s].player?t.push("Pawn 1"):t.push("Pawn 2"):e[s]instanceof P?1===e[s].player?t.push("Queen 1"):t.push("Queen 2"):e[s]instanceof d?1===e[s].player?t.push("Bishop 1"):t.push("Bishop 2"):e[s]instanceof y?1===e[s].player?t.push("Knight 1"):t.push("Knight 2"):e[s]instanceof w&&(1===e[s].player?t.push("Rook 1"):t.push("Rook 2")):t.push(0);return console.log("textSquares"),console.log(t),t}},{key:"setBishop",value:function(){var e=this.state.squares;1===this.state.player?(e[this.state.changePawn]=new d(2),this.setState({squares:e,changePawn:-1})):(e[this.state.changePawn]=new d(1),this.setState({squares:e,changePawn:-1}));var t=this.classesToStrings(this.state.squares),s={roundID:this.state.roundID,board:t,dontChange:!0};this.state.socket.emit("update",s)}},{key:"setQueen",value:function(){var e=this.state.squares;1===this.state.player?(e[this.state.changePawn]=new P(2),this.setState({squares:e,changePawn:-1})):(e[this.state.changePawn]=new P(1),this.setState({squares:e,changePawn:-1}));var t=this.classesToStrings(this.state.squares),s={roundID:this.state.roundID,board:t,dontChange:!0};this.state.socket.emit("update",s)}},{key:"setKnight",value:function(){var e=this.state.squares;1===this.state.player?(e[this.state.changePawn]=new y(2),this.setState({squares:e,changePawn:-1})):(e[this.state.changePawn]=new y(1),this.setState({squares:e,changePawn:-1}));var t=this.classesToStrings(this.state.squares),s={roundID:this.state.roundID,board:t,dontChange:!0};this.state.socket.emit("update",s)}},{key:"setRook",value:function(){var e=this.state.squares;1===this.state.player?(e[this.state.changePawn]=new w(2),this.setState({squares:e,changePawn:-1})):(e[this.state.changePawn]=new w(1),this.setState({squares:e,changePawn:-1}));var t=this.classesToStrings(this.state.squares),s={roundID:this.state.roundID,board:t,dontChange:!0};this.state.socket.emit("update",s)}},{key:"render",value:function(){var e=this,t=!1;-1!==this.state.changePawn&&(t=!0);var s=function(e){var t;switch(e){case-3:t="Unauthorized connection.";break;case-2:t="Redirecting...";break;case-1:t="No connection found.";break;case 0:t="Connected!";break;case 1:t="Wait for opponent to connect.";break;case 2:t="The game is active.";break;case 3:t="The game is completed!";break;case 4:t="The opponent left.";break;case 5:t="Spectator mode.";break;default:t="Undefined status."}return t}(this.state.connectionStatus),a=function(e,t){var s;return 5!==t&&(3===e?s="VICTORY!":1===e?s="DEFEAT!":2===e&&(s="TIE!")),s}(this.state.endstate,this.state.connectionStatus);if(5!==this.state.connectionStatus)var n=function(e,t){var s;return 2===e&&(s=t?"Your turn.":"Opponent's turn."),s}(this.state.connectionStatus,this.state.myTurn),r='Your color: <div id="player-turn-box" style="background-color:'+this.state.myColor+'"></div>';return i.a.createElement("div",{className:"game"},i.a.createElement("div",{className:"game-title"},i.a.createElement("div",null,"Chess")),i.a.createElement("div",{className:"game-board"},i.a.createElement(p,{squares:this.state.squares,onClick:function(t){return e.handleClick(t)}})),i.a.createElement("div",{className:"game-info"},i.a.createElement("div",null,s),i.a.createElement("td",{dangerouslySetInnerHTML:{__html:r}}),i.a.createElement("div",null,n),i.a.createElement("div",{className:"game-status"},this.state.kingStatus),i.a.createElement("div",{className:"game-status"},this.state.status),i.a.createElement("div",{className:"fallen-soldier-block"},i.a.createElement(b,{whiteFallenSoldiers:this.state.whiteFallenSoldiers,blackFallenSoldiers:this.state.blackFallenSoldiers})),t?i.a.createElement("div",null," ",i.a.createElement("button",{onClick:this.setBishop}," Bishop "),i.a.createElement("button",{onClick:this.setQueen}," Queen "),i.a.createElement("button",{onClick:this.setKnight}," Knight "),i.a.createElement("button",{onClick:this.setRook}," Rook ")):i.a.createElement("div",null," ")),i.a.createElement("div",{id:"endstate"},a))}}]),s}(i.a.Component);r.a.render(i.a.createElement(q,null),document.getElementById("root"))},9:function(e,t,s){}},[[36,1,2]]]);
//# sourceMappingURL=main.85f07e92.chunk.js.map