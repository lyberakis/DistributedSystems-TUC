(this["webpackJsonptic-tac-toe"]=this["webpackJsonptic-tac-toe"]||[]).push([[0],{17:function(e,t,a){},36:function(e,t,a){e.exports=a(74)},71:function(e,t){},74:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(33),o=a.n(r),u=(a(17),a(5)),c=a(12),i=a(13),l=a(15),d=a(14),m=a(35);function h(e){for(var t=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]],a=0;a<t.length;a++){var n=Object(m.a)(t[a],3),s=n[0],r=n[1],o=n[2];if(e[s]&&e[s]===e[r]&&e[s]===e[o])return f(t[a]),e[s]}return null}function f(e){var t;for(t in e)document.getElementsByClassName("square")[e[t]].style.textShadow="red 0px 0px 10px"}function v(e){for(var t=0;t<e.length;t++)if(null==e[t])return!1;return!0}var p=a(34),k=a.n(p);function y(e,t){var a={query:"token="+t},n=k()(e,a);return{socket:n,status:n.connected?0:-1}}function b(e){return s.a.createElement("button",{className:"square",onClick:e.onClick},e.value)}var E=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"renderSquare",value:function(e){var t=this;return s.a.createElement(b,{value:this.props.squares[e],onClick:function(){return t.props.onClick(e)}})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{className:"board-row"},this.renderSquare(0),this.renderSquare(1),this.renderSquare(2)),s.a.createElement("div",{className:"board-row"},this.renderSquare(3),this.renderSquare(4),this.renderSquare(5)),s.a.createElement("div",{className:"board-row"},this.renderSquare(6),this.renderSquare(7),this.renderSquare(8)))}}]),a}(s.a.Component),g=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(c.a)(this,a),n=t.call(this,e);var s,r=function(){var e=window.location.href,t=new URL(e),a=t.hostname,n=t.searchParams.get("pm"),s=t.searchParams.get("gm");return{host:a,token:t.searchParams.get("token"),playmanster:n,gamemaster:s}}(),o=y(r.host+":"+r.playmanster,r.token);return n.state={host:r.host,gamemaster:r.gamemaster,squares:Array(9).fill(null),myTurn:!1,token:r.token,socket:o.socket,status:o.status,type:null,roundID:null},(s=Object(u.a)(n)).state.socket.on("wait",(function(e){s.setState({status:1,roundID:e.roundID})})),s.state.socket.on("init",(function(e){if(null===s.state.type){var t=e.turn,a=t?"X":"O";s.setState({status:2,type:a,myTurn:t,roundID:e.roundID})}else s.setState({status:2,roundID:e.roundID})})),s.state.socket.on("viewer",(function(e){console.log("VIWER"),s.setState({status:5,squares:e})})),s.state.socket.on("board",(function(e){var t=e.board;e.progress,s.setState({squares:t,myTurn:!0});var a=h(t),n=v(t);(a||n)&&s.setState({status:3})})),s.state.socket.on("disconnect",(function(e){if(!(s.state.status<0||s.state.status>2)){s.state.socket.disconnect(),s.setState({status:4});var t=new XMLHttpRequest;t.onload=function(e){if(4===t.readyState)if(200===t.status){var a=JSON.parse(t.responseText);s.reconnect(a.playmaster)}else 403===t.status&&s.setState({status:-3})};var a="http://"+s.state.host+":"+s.state.gamemaster+"?token="+s.state.token+"&game=tic-tac-toe";t.open("GET",a),t.send()}})),s.state.socket.on("endgame",(function(e){s.setState({status:4}),s.state.socket.disconnect()})),n}return Object(i.a)(a,[{key:"handleClick",value:function(e){if(this.state.myTurn&&5!==this.state.state){var t=this.state.squares.slice();if(h(t)||t[e])return;t[e]=this.state.type,this.setState({squares:t,myTurn:!this.state.myTurn});var a=h(t),n=v(t),s=0;a===this.state.type?s=1:null===a&&n&&(s=2),(n||a)&&this.setState({status:3});var r={roundID:this.state.roundID,board:t,progress:s};console.log(r),this.state.socket.emit("update",r)}}},{key:"setupBeforeUnloadListener",value:function(){window.addEventListener("beforeunload",(function(e){return e.preventDefault(),"Are you sure you want to leave?"}))}},{key:"componentDidMount",value:function(){this.setupBeforeUnloadListener()}},{key:"render",value:function(){var e=this,t=h(this.state.squares),a=v(this.state.squares),n=function(e){var t;switch(e){case-3:t="Unauthorized connection.";break;case-2:t="Redirecting...";break;case-1:t="No connection found.";break;case 0:t="Connected!";break;case 1:t="Wait for opponent to connect.";break;case 2:t="The game is active.";break;case 3:t="The game is completed!";break;case 4:t="The opponent left.";break;case 5:t="Spectator mode.";break;default:t="Undefined status."}return t}(this.state.status),r=function(e,t,a,n){var s;return 5!==n?null!==t&&e===t||4===n?s="VICTORY!":null!=e&&e!==t?s="DEFEAT!":null==e&&!0===a&&(s="TIE!"):null!==e?s="WINNER: "+e:a&&(s="TIE!"),s}(t,this.state.type,a,this.state.status);if(5!==this.state.status)var o=function(e,t){var a;return 2===e&&(a=t?"Your turn.":"Opponent's turn."),a}(this.state.status,this.state.myTurn),u=function(e){var t;return e&&(t="You are: "+e),t}(this.state.type);return s.a.createElement("div",{className:"game bg"},s.a.createElement("div",{className:"game-title"},s.a.createElement("div",null,"Tic - Tac - Toe")),s.a.createElement("div",{className:"game-board"},s.a.createElement(E,{squares:this.state.squares,onClick:function(t){return e.handleClick(t)}})),s.a.createElement("div",{className:"game-info row"},s.a.createElement("div",{className:"status column left"},s.a.createElement("div",null,u),s.a.createElement("div",null,n),s.a.createElement("div",null,o)),s.a.createElement("div",{className:"column right"},s.a.createElement("div",{id:"endstate"},r))))}}]),a}(s.a.Component);o.a.render(s.a.createElement(g,null),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.b42dc1af.chunk.js.map